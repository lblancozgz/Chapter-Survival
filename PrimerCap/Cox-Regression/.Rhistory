+ mwimin + mwime + mwimax,
data= new_df_gdd)
summary(cox_rhs2)
rms::vif(cox_rhs2)
#mwimean has a lot of collinearity so we should remove it and do it again
cox_rhs3 <- coxph(Surv(total_lived, censored) ~ minrh + maxrh
+ mwimin  + mwimax,
data= new_df_gdd)
summary(cox_rhs3)
rms::vif(cox_rhs3)
#Shall we eliminate a variable here?
stats::step(cox_rhs3)
#nop
summary(cox_rhs3)
#Random effects - Separated
coxme_rh_s<- coxme(Surv(total_lived, censored) ~ minrh + meanrh
+ maxrh + mwimin + mwime + mwimax  +
(1|location) + (1|method), data= new_df_gdd)
summary(coxme_rh_s)
rms::vif(coxme_rh_s)
#meanrh has a lot of collinearity so we should remove it and do it again
coxme_rh_s2<- coxme(Surv(total_lived, censored) ~ minrh + maxrh + mwimin + mwime + mwimax  +
(1|location) + (1|method), data= new_df_gdd)
summary(coxme_rh_s2)
rms::vif(coxme_rh_s2)
#mwimean has a lot of collinearity, so we remove it and do it again
coxme_rh_s3<- coxme(Surv(total_lived, censored) ~ minrh + maxrh + mwimin + mwimax  +
(1|location) + (1|method), data= new_df_gdd)
coxme_rh_s3
exp(confint(coxme_rh_s3))
rms::vif(coxme_rh_s3)
#Random effects - Together
coxme_rh_t<- coxme(Surv(total_lived, censored) ~ minrh + meanrh
+ maxrh + mwimin + mwime + mwimax  +
(1|location/method), data= new_df_gdd)
summary(coxme_rh_t)
rms::vif(coxme_rh_t)
#meanrh has a lot of collinearity so we should remove it and do it again
coxme_rh_t2<- coxme(Surv(total_lived, censored) ~ minrh + maxrh + mwimin + mwime + mwimax  +
(1|location/method), data= new_df_gdd)
summary(coxme_rh_t2)
rms::vif(coxme_rh_t2)
#meanmwi has a lot of collinearity so we should remove it and do it again
coxme_rh_t3<- coxme(Surv(total_lived, censored) ~ minrh + maxrh + mwimin  + mwimax  +
(1|location/method), data= new_df_gdd)
exp(confint(coxme_rh_s3))
coxme_rh_t3
# No random effect
cox_pho<- coxph(Surv(total_lived, censored) ~ photoperiod,
data= new_df_gdd)
summary(cox_pho)
#Random effect - separated
coxme_pho_s<- coxme(Surv(total_lived, censored) ~ photoperiod +
(1|location) + (1|method), data= new_df_gdd)
summary(coxme_pho_s)
#Random effect - together
coxme_pho_t<- coxme(Surv(total_lived, censored) ~ photoperiod +
(1|location/method), data= new_df_gdd)
summary(coxme_pho_t)
#No random effect
coxph_allv<- coxph(Surv(total_lived, censored) ~ photoperiod + minrh + meanrh +
maxrh + mintemperature + meantemperature + maxtemperature +
mwimin + mwimax + daily_acc_gdd +location + method, data= new_df_gdd)
summary(coxph_allv)
rms::vif(coxph_allv) #gdd and meant with high vif
cox_allv2<- coxph(Surv(total_lived, censored) ~ photoperiod + minrh + meanrh +
maxrh + mintemperature  + maxtemperature +
mwimin + mwimax + meantemperature+ location + method, data= new_df_gdd)
summary(cox_allv2)
rms::vif(cox_allv2) #meant with high vif
cox_allv3<- coxph(Surv(total_lived, censored) ~ photoperiod + minrh  + meanrh +
maxrh + mintemperature  + maxtemperature +
mwimin + mwimax +location + method, data= new_df_gdd)
summary(cox_allv3)
rms::vif(cox_allv3) #meanrh with high vif
cox_allv4<- coxph(Surv(total_lived, censored) ~ photoperiod + minrh  +
maxrh   + mintemperature +
mwimin + mwimax +  maxtemperature + location + method, data= new_df_gdd)
summary(cox_allv4)
rms::vif(cox_allv4)
cox_allv5<- coxph(Surv(total_lived, censored) ~ photoperiod + minrh  +
maxrh   + mintemperature +
mwimax +  maxtemperature + location + method, data= new_df_gdd)
summary(cox_allv5)
rms::vif(cox_allv5)
cox_allv6<- coxph(Surv(total_lived, censored) ~ photoperiod + minrh  +
maxrh   + mintemperature +
mwimax  + location + method, data= new_df_gdd)
rms::vif(cox_allv6) #we have removed maxtemperature and mwimin!
##MODELS##
coxph_1<- coxph(Surv(total_lived, censored) ~ photoperiod +  mwimax  +
location + method, data= new_df_gdd)
summary(coxph_1)
coxph_2<- coxph(Surv(total_lived, censored) ~ photoperiod +  mwimin +
+ location + method,
data= new_df_gdd)
summary(coxph_2)
library("texreg")
coxph_3<- coxph(Surv(total_lived, censored) ~ photoperiod + mintemperature
+ minrh +  location + method,
data= new_df_gdd)
summary(coxph_3)
coxph_4<- coxph(Surv(total_lived, censored) ~ photoperiod + mintemperature
+ maxrh +  location + method,
data= new_df_gdd)
summary(coxph_4)
coxph_5<- coxph(Surv(total_lived, censored) ~ photoperiod + daily_acc_gdd +
minrh + location + method,
data= new_df_gdd)
summary(coxph_5)
coxph_6<- coxph(Surv(total_lived, censored) ~ photoperiod + daily_acc_gdd +
maxrh + location + method,
data= new_df_gdd)
summary(coxph_6)
#Random effect - separated
coxme_allv<- coxme(Surv(total_lived, censored) ~ photoperiod + minrh + meanrh +
maxrh + mintemperature + meantemperature + maxtemperature +
mwimin + mwimax + daily_acc_gdd + (1|location) + (1|method),
data= new_df_gdd)
summary(coxme_allv)
rms::vif(coxme_allv) #gdd with high vif
coxme_allv2<- coxme(Surv(total_lived, censored) ~ photoperiod + minrh + meanrh +
maxrh + mintemperature  + maxtemperature +
mwimin + mwimax + meantemperature+ (1|location) + (1|method),
data= new_df_gdd)
summary(coxme_allv2)
rms::vif(coxme_allv2) #meantemperature with high vif
coxme_allv3<- coxme(Surv(total_lived, censored) ~ photoperiod + minrh  + meanrh +
maxrh + mintemperature  + maxtemperature +
mwimin + mwimax + (1|location) + (1|method), data= new_df_gdd)
summary(coxme_allv3)
rms::vif(coxme_allv3) #meanrh with high vif
coxme_allv4<- coxme(Surv(total_lived, censored) ~ photoperiod + minrh  +
maxrh +  mwimin + mwimax + mintemperature + maxtemperature +
(1|location) + (1|method),
data= new_df_gdd,
refine.n = 500)
rms::vif(coxme_allv4) #removing maxtemperature
coxme_allv5<- coxme(Surv(total_lived, censored) ~ photoperiod + minrh  +
maxrh + mintemperature +mwimin +mwimax+  (1|location) + (1|method),
data= new_df_gdd,
refine.n = 500)
rms::vif(coxme_allv5) #we know now the variables that doesn't have collinearity
coxme_allv5_gdd <- coxme(Surv(total_lived, censored) ~ photoperiod + minrh  +
maxrh + daily_acc_gdd +mwimin +mwimax+  (1|location) + (1|method),
data= new_df_gdd,
refine.n = 500)
rms::vif(coxme_allv5_gdd) #if we change temperature and put gdd, we still not
#have collinearity
##Random effect - together
coxme_allv_t<- coxme(Surv(total_lived, censored) ~ photoperiod + minrh + meanrh +
maxrh + mintemperature + meantemperature + maxtemperature +
mwimin + mwimax + (1|location/method), data= new_df_gdd)
summary(coxme_allv_t)
rms::vif(coxme_allv_t) #meantemperature with high vif
coxme_allv_t2<- coxme(Surv(total_lived, censored) ~ photoperiod + minrh + meanrh +
maxrh + mintemperature + maxtemperature +
mwimin + mwimax + (1|location/method), data= new_df_gdd)
summary(coxme_allv_t2)
rms::vif(coxme_allv_t2) #meanrh with highest vif
coxme_allv_t3<- coxme(Surv(total_lived, censored) ~ photoperiod + minrh  +
maxrh + mintemperature + maxtemperature +
mwimin + mwimax + (1|location/method), data= new_df_gdd)
summary(coxme_allv_t3)
rms::vif(coxme_allv_t3) #maxtemperature with highest vif
coxme_allv_t4<- coxme(Surv(total_lived, censored) ~ photoperiod + minrh  +
maxrh + mintemperature  +
mwimin + mwimax + (1|location/method), data= new_df_gdd)
rms::vif(coxme_allv_t4) #maxtemperature with highest vif
#model 1.
model1<- coxme(Surv(total_lived, censored) ~ photoperiod + mwimax +
(1|location)+ (1|method) +(1|location/method),
data= new_df_gdd,
refine.n = 500)
exp(confint(model1))
model1
model2<- coxme(Surv(total_lived, censored) ~ photoperiod + mwimin  +
(1|location)+ (1|method) +(1|location/method),
data= new_df_gdd,
refine.n = 500)
exp(confint(model2))
model2
model3<- coxme(Surv(total_lived, censored) ~ photoperiod + mintemperature+ minrh  +
(1|location)+ (1|method) +(1|location/method),
data= new_df_gdd,
refine.n = 500)
exp(confint(model3))
model3
model4<- coxme(Surv(total_lived, censored) ~ photoperiod + mintemperature+ maxrh  +
(1|location)+ (1|method) +(1|location/method),
data= new_df_gdd,
refine.n = 500)
model4
exp(confint(model4))
model5<- coxme(Surv(total_lived, censored) ~ photoperiod + daily_acc_gdd  +
minrh +  (1|location)+ (1|method) +(1|location/method),
data= new_df_gdd,
refine.n = 500)
model5
exp(confint(model5))
model6<- coxme(Surv(total_lived, censored) ~ photoperiod + daily_acc_gdd  +
maxrh +  (1|location)+ (1|method) +(1|location/method),
data= new_df_gdd,
refine.n = 500)
model6
exp(confint(model6))
#model 1.
model1<- coxme(Surv(total_lived, censored) ~ photoperiod + mwimax +
(1|location/method),
data= new_df_gdd,
refine.n = 500)
exp(confint(model1))
model1
model2<- coxme(Surv(total_lived, censored) ~ photoperiod + mwimin  +
(1|location/method),
data= new_df_gdd,
refine.n = 500)
exp(confint(model2))
model2
model3<- coxme(Surv(total_lived, censored) ~ photoperiod + mintemperature+
minrh  +
(1|location/method),
data= new_df_gdd,
refine.n = 500)
exp(confint(model3))
model3
model4<- coxme(Surv(total_lived, censored) ~ photoperiod + mintemperature+ maxrh
+(1|location/method),
data= new_df_gdd,
refine.n = 500)
model4
exp(confint(model4))
model5<- coxme(Surv(total_lived, censored) ~ photoperiod + daily_acc_gdd  +
minrh +(1|location/method),
data= new_df_gdd,
refine.n = 500)
model5
exp(confint(model5))
model6<- coxme(Surv(total_lived, censored) ~ photoperiod + daily_acc_gdd  +
maxrh +(1|location/method),
data= new_df_gdd,
refine.n = 500)
model6
exp(confint(model6))
model1<- coxme(Surv(total_lived, censored) ~ photoperiod + mwimax +
(1|location)+ (1|method),
data= new_df_gdd,
refine.n = 500)
exp(confint(model1))
model1
model2<- coxme(Surv(total_lived, censored) ~ photoperiod + mwimin  +
(1|location)+ (1|method),
data= new_df_gdd,
refine.n = 500)
exp(confint(model2))
model2
model3<- coxme(Surv(total_lived, censored) ~ photoperiod + mintemperature+ minrh  +
(1|location)+ (1|method),
data= new_df_gdd,
refine.n = 500)
exp(confint(model3))
model3
model4<- coxme(Surv(total_lived, censored) ~ photoperiod + mintemperature+ maxrh  +
(1|location)+ (1|method),
data= new_df_gdd,
refine.n = 500)
model4
exp(confint(model4))
model5<- coxme(Surv(total_lived, censored) ~ photoperiod + daily_acc_gdd  +
minrh +  (1|location)+ (1|method),
data= new_df_gdd,
refine.n = 500)
model5
exp(confint(model5))
model6<- coxme(Surv(total_lived, censored) ~ photoperiod + daily_acc_gdd  +
maxrh +  (1|location)+ (1|method),
data= new_df_gdd,
refine.n = 500)
model6
exp(confint(model6))
library(corrplot)
library(RColorBrewer)
t = cbind(new_df_gdd$id_mosquito, new_df_gdd$method, new_df_gdd$location, new_df_gdd$maxtemperature,
new_df_gdd$mintemperature, new_df_gdd$minrh, new_df_gdd$maxrh, new_df_gdd$photoperiod,new_df_gdd$daily_acc_gdd,
new_df_gdd$mwimax, new_df_gdd$mwimin)
colnames(t) <- c("id_mosquito", "method", "location", "maxtemperature", "mintemperature", "minrh","maxrh", "photoperiod", "gdd", "mwimax", "mwimin")
t<- as.data.frame(t)
M <-cor(t)
corrp<- corrplot(M, type="upper", order="hclust",
col=brewer.pal(n=8, name="RdYlBu"))
#loglik calculation in normal cox
cox3 <- coxph(formula = Surv(total_lived, censored) ~ photoperiod + mintemperature +
minrh, data = new_df_gdd)
cox3$loglik #-124994.3
cox6 <- coxph(formula = Surv(total_lived, censored) ~ photoperiod + daily_acc_gdd +
maxrh, data = new_df_gdd)
cox6$loglik #-124975.3
#loglik calculation with levels: COX vs INTERACTION+LEVELS
model3all<- coxme(Surv(total_lived, censored) ~ photoperiod + mintemperature+ minrh  +
(1|location)+ (1|method) +(1|location/method),
data= new_df_gdd,
refine.n = 500)  #loglik -124826.7
2*(-124826.7+124994.3) #335.2
pchisq(335.2,5,lower.tail = F) #2.684731e-70
model6all<- coxme(Surv(total_lived, censored) ~ photoperiod + daily_acc_gdd  +
maxrh +  (1|location)+ (1|method) +(1|location/method),
data= new_df_gdd,
refine.n = 500) #loglik -124826.7
2*(-124826.7+124975.3) #297.2
pchisq(297.2,5,lower.tail = F) #4.005055e-62
#loglik calculation with levels: Cox with separated interactions
model3sep<- coxme(Surv(total_lived, censored) ~ photoperiod + mintemperature+ minrh  +
(1|location)+ (1|method),
data= new_df_gdd,
refine.n = 500) #loglik -124829.7
2*(-124829.7+124994.3) #329.2
pchisq(329.2,5,lower.tail = F) #5.249144e-69
model6sep<- coxme(Surv(total_lived, censored) ~ photoperiod + daily_acc_gdd  +
maxrh +  (1|location)+ (1|method),
data= new_df_gdd,
refine.n = 500) #loglik -124830.2
2*(-124830.2+124975.3) #290.2
pchisq(290.2,5,lower.tail = F) #1.280022e-60
#loglik calculations with levels: COX vs interaction
model3all<- coxme(Surv(total_lived, censored) ~ photoperiod + mintemperature+ minrh  +
(1|location/method),
data= new_df_gdd,
refine.n = 500)  #loglik -124827.6
2*(-124827.6+124994.3) #333.4
pchisq(333.4,5,lower.tail = F) #6.550569e-70
model6all<- coxme(Surv(total_lived, censored) ~ photoperiod + daily_acc_gdd  +
maxrh +(1|location/method),
data= new_df_gdd,
refine.n = 500) #loglik -124827.6
2*(-124827.6+124975.3) #295.4
pchisq(295.4,5,lower.tail = F) #9.762086e-62
#model 3 with photoperiod
model3all<- coxme(Surv(total_lived, censored) ~ photoperiod + mintemperature+ minrh  +
(1|location)+ (1|method) +(1|location/method),
data= new_df_gdd,
refine.n = 500)
#model 3 WITHOUT photoperiod
model3without<- coxme(Surv(total_lived, censored) ~  mintemperature+ minrh  +
(1|location)+ (1|method) +(1|location/method),
data= new_df_gdd,
refine.n = 500)
model3without
#model only photoperiod
modelphotoperiod<- coxme(Surv(total_lived, censored) ~ photoperiod +
(1|location)+ (1|method) +(1|location/method),
data= new_df_gdd,
refine.n = 500)
modelphotoperiod
#model 6 with photoperiod
model6all
#model 6 with photoperiod
model6all<- coxme(Surv(total_lived, censored) ~ photoperiod + daily_acc_gdd  +
maxrh +  (1|location)+ (1|method) +(1|location/method),
data= new_df_gdd,
refine.n = 500)
#model 6 WITHOUT photoperiod
model6without<- coxme(Surv(total_lived, censored) ~  daily_acc_gdd  +
maxrh +  (1|location)+ (1|method) +(1|location/method),
data= new_df_gdd,
refine.n = 500)
model6without
model3without
#new loglik calculations
coxph3
#new loglik calculations
coxph_3
#new loglik calculations
coxph_3 <- coxph(formula = Surv(total_lived, censored) ~  mintemperature +
minrh + location + method, data = new_df_gdd)
#new loglik calculations
coxph_3.2 <- coxph(formula = Surv(total_lived, censored) ~  mintemperature +
minrh + location + method, data = new_df_gdd)
coxph_3.2$loglik
model3without
#new loglik calculations
coxph_3.2 <- coxph(formula = Surv(total_lived, censored) ~  mintemperature +
minrh, data = new_df_gdd)
coxph_3.2$loglik # -124958.5
2*(-125156.1+124963.9) #333.4
2*(-124963.9+125156.1) #333.4
coxph_3.2
pchisq(384.4,2,lower.tail = F) #6.550569e-70
pchisq(384.4,5,lower.tail = F) #6.550569e-70
pchisq(384.4,2,lower.tail = F) #6.550569e-70
coxph_6
coxph_6.2 <- coxph(formula = Surv(total_lived, censored) ~ daily_acc_gdd +
maxrh, data = new_df_gdd)
coxph_6.2$loglik
model6without
2*(-124975.9+125167.0) #384.4
pchisq(382.2,2,lower.tail = F) #3.377541e-84
model3without
#model 5 with photoperiod
model5all<- coxme(Surv(total_lived, censored) ~ photoperiod + daily_acc_gdd  +
minrh +  (1|location)+ (1|method) +(1|location/method),
data= new_df_gdd,
refine.n = 500)
#model 5 without photoperiod
model5without <- coxme(Surv(total_lived, censored) ~ daily_acc_gdd  +
minrh +  (1|location)+ (1|method) +(1|location/method),
data= new_df_gdd,
refine.n = 500)
model5without
#model 4 with photoperiod
model4all<- coxme(Surv(total_lived, censored) ~ photoperiod + mintemperature+ maxrh  +
(1|location)+ (1|method) +(1|location/method),
data= new_df_gdd,
refine.n = 500)
#model 4 without photoperiod
model4without<- coxme(Surv(total_lived, censored) ~ mintemperature+ maxrh  +
(1|location)+ (1|method) +(1|location/method),
data= new_df_gdd,
refine.n = 500)
model4without
model3without
model4without
model5without
model6without
#model 3 with photoperiod
model3sep<- coxme(Surv(total_lived, censored) ~ photoperiod + mintemperature+ minrh  +
(1|location)+ (1|method),
data= new_df_gdd,
refine.n = 500)
model3sep
#model 3 WITHOUT photoperiod
model3sepwithout<- coxme(Surv(total_lived, censored) ~  mintemperature+ minrh  +
(1|location)+ (1|method),
data= new_df_gdd,
refine.n = 500)
model3sepwithout
#model 4 with photoperiod
model4sep<- coxme(Surv(total_lived, censored) ~ photoperiod + mintemperature+ maxrh  +
(1|location)+ (1|method),
data= new_df_gdd,
refine.n = 500)
#model 4 without photoperiod
model4sepwithout<- coxme(Surv(total_lived, censored) ~ mintemperature+ maxrh  +
(1|location)+ (1|method),
data= new_df_gdd,
refine.n = 500)
model4sepwithout
#model 5 with photoperiod
model5sep<- coxme(Surv(total_lived, censored) ~ photoperiod + daily_acc_gdd  +
minrh +  (1|location)+ (1|method),
data= new_df_gdd,
refine.n = 500)
#model 5 without photoperiod
model5sepwithout <- coxme(Surv(total_lived, censored) ~ daily_acc_gdd  +
minrh +  (1|location)+ (1|method),
data= new_df_gdd,
refine.n = 500)
model5sepwithout
#model 6 with photoperiod
model6sep<- coxme(Surv(total_lived, censored) ~ photoperiod + daily_acc_gdd  +
maxrh +  (1|location)+ (1|method),
data= new_df_gdd,
refine.n = 500)
#model 6 WITHOUT photoperiod
model6sepwithout<- coxme(Surv(total_lived, censored) ~  daily_acc_gdd  +
maxrh +  (1|location)+ (1|method),
data= new_df_gdd,
refine.n = 500)
model6sepwithout
#model 3 with photoperiod
model3int<- coxme(Surv(total_lived, censored) ~ photoperiod + mintemperature+ minrh  +
(1|location/method),
data= new_df_gdd,
refine.n = 500)
#model 3 WITHOUT photoperiod
model3intwithout<- coxme(Surv(total_lived, censored) ~  mintemperature+ minrh  +
(1|location/method),
data= new_df_gdd,
refine.n = 500)
model3intwithout
#model 4 with photoperiod
model4int<- coxme(Surv(total_lived, censored) ~ photoperiod + mintemperature+ maxrh  +
(1|location/method),
data= new_df_gdd,
refine.n = 500)
#model 4 without photoperiod
model4intwithout<- coxme(Surv(total_lived, censored) ~ mintemperature+ maxrh  +
(1|location/method),
data= new_df_gdd,
refine.n = 500)
model4intwithout
#model 5 with photoperiod
model5int<- coxme(Surv(total_lived, censored) ~ photoperiod + daily_acc_gdd  +
minrh +(1|location/method),
data= new_df_gdd,
refine.n = 500)
#model 5 without photoperiod
model5intwithout <- coxme(Surv(total_lived, censored) ~ daily_acc_gdd  +
minrh +(1|location/method),
data= new_df_gdd,
refine.n = 500)
model5intwithout
#model 6 with photoperiod
model6int<- coxme(Surv(total_lived, censored) ~ photoperiod + daily_acc_gdd  +
maxrh +  (1|location/method),
data= new_df_gdd,
refine.n = 500)
#model 6 WITHOUT photoperiod
model6intwithout<- coxme(Surv(total_lived, censored) ~  daily_acc_gdd  +
maxrh +(1|location/method),
data= new_df_gdd,
refine.n = 500)
model6intwithout
